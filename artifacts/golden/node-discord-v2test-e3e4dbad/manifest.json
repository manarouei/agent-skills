{
  "correlation_id": "node-discord-v2test-e3e4dbad",
  "node_type": null,
  "skill_name": "code-convert",
  "created_at": "2026-01-06T04:47:27.224914",
  "generated_code": {
    "discord.py": "#!/usr/bin/env python3\n\"\"\"\nDiscord Node\n\nConverted from TypeScript by agent-skills/code-convert\nCorrelation ID: node-discord-v2test-e3e4dbad\nGenerated: 2026-01-06T04:47:27.221655\n\nSYNC-CELERY SAFE: All methods are synchronous with timeouts.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport logging\nfrom typing import Any, Dict, List\n\nimport requests\n\nfrom .base import BaseNode, NodeParameterType, NodeExecutionData\n\nlogger = logging.getLogger(__name__)\n\n\nclass DiscordNode(BaseNode):\n    \"\"\"\n    Discord node.\n    \n    \n    \"\"\"\n\n    type = \"discord\"\n    version = 1\n    \n    description = {\n        \"displayName\": \"Discord\",\n        \"name\": \"discord\",\n        \"icon\": \"file:discord.svg\",\n        \"group\": ['output'],\n        \"description\": \"\",\n        \"inputs\": [{\"name\": \"main\", \"type\": \"main\", \"required\": True}],\n        \"outputs\": [{\"name\": \"main\", \"type\": \"main\", \"required\": True}],\n    }\n    \n    properties = {\n        \"parameters\": [\n            {\"name\": \"resource\", \"type\": NodeParameterType.OPTIONS, \"display_name\": \"Resource\", \"options\": [\n                {\"name\": \"Channel\", \"value\": \"channel\"},\n                {\"name\": \"Message\", \"value\": \"message\"},\n                {\"name\": \"Member\", \"value\": \"member\"}\n            ], \"default\": \"channel\", \"description\": \"The resource to operate on\"},\n            {\"name\": \"authentication\", \"type\": NodeParameterType.OPTIONS, \"display_name\": \"Connection Type\", \"options\": [\n                {\"name\": \"Bot Token\", \"value\": \"botToken\"},\n                {\"name\": \"OAuth2\", \"value\": \"oAuth2\"},\n                {\"name\": \"Webhook\", \"value\": \"webhook\"}\n            ], \"default\": \"botToken\"}\n        ],\n        \"credentials\": [\n            {\"name\": \"discordBotApi\", \"required\": True}\n        ]\n    }\n    \n    icon = \"discord.svg\"\n\n    def execute(self) -> List[List[NodeExecutionData]]:\n        \"\"\"\n        Execute the node operations.\n        \n        SYNC-CELERY SAFE: All HTTP calls use timeout parameter.\n        \n        Returns:\n            List[List[NodeExecutionData]]: Nested list where outer list is output branches,\n            inner list is items in that branch.\n        \"\"\"\n        # Get input data from previous node\n        input_data = self.get_input_data()\n        \n        # Handle empty input\n        if not input_data:\n            return [[]]\n        \n        return_items: List[NodeExecutionData] = []\n\n        for i, item in enumerate(input_data):\n            try:\n                operation = self.get_node_parameter(\"operation\", i)\n                item_data = item.json_data if hasattr(item, 'json_data') else item.get('json', {})\n                \n                if operation == \"execute\":\n                    result = self._execute(i, item_data)\n                else:\n                    raise ValueError(f\"Unknown operation: {operation}\")\n                \n                # Handle array results\n                if isinstance(result, list):\n                    for r in result:\n                        return_items.append(NodeExecutionData(json_data=r))\n                else:\n                    return_items.append(NodeExecutionData(json_data=result))\n                    \n            except Exception as e:\n                logger.error(f\"Error in operation {operation}: {e}\")\n                if self.continue_on_fail:\n                    return_items.append(NodeExecutionData(json_data={\"error\": str(e)}))\n                else:\n                    raise\n        \n        return [return_items]\n\n    def _api_request(\n        self,\n        method: str,\n        endpoint: str,\n        body: Dict[str, Any] | None = None,\n        query: Dict[str, Any] | None = None,\n    ) -> Dict[str, Any]:\n        \"\"\"\n        Make authenticated API request.\n        \n        SYNC-CELERY SAFE: Uses requests with timeout.\n        \"\"\"\n        credentials = self.get_credentials(\"discordBotApi\")\n        \n        # Build headers based on credential type\n        headers = {}\n        if credentials.get(\"accessToken\"):\n            headers[\"Authorization\"] = f\"Bot {credentials.get('accessToken')}\"\n        elif credentials.get(\"apiKey\"):\n            query = query or {}\n            query[\"api_key\"] = credentials.get(\"apiKey\")\n        \n        url = f\"https://api.example.com{endpoint}\"\n        \n        response = requests.request(\n            method,\n            url,\n            params=query,\n            json=body,\n            headers=headers,\n            timeout=30,  # REQUIRED for Celery\n        )\n        response.raise_for_status()\n        return response.json()\n\n    def _execute(self, item_index: int, item_data: Dict[str, Any]) -> Dict[str, Any]:\n        \"\"\"\n        execute operation.\n        \n        Args:\n            item_index: Index of the current item being processed\n            item_data: JSON data from the input item\n            \n        Returns:\n            Dict with operation result\n            \n        TODO: Implement operation logic.\n        \"\"\"\n        # TODO: Extract parameters using item_index\n        # param = self.get_node_parameter(\"paramName\", item_index)\n        \n        # TODO: Make API call\n        # response = self._api_request(\"GET\", \"/endpoint\", query={\"param\": param})\n        \n        raise NotImplementedError(\"execute operation not implemented\")\n\n",
    "__init__.py": "\"\"\"\nDiscord Node Package\nConverted from TypeScript by agent-skills/code-convert\n\"\"\"\n\nfrom .discord import DiscordNode\n\n__all__ = [\"DiscordNode\"]\n"
  },
  "node_schema": {
    "type": "discord",
    "version": 1,
    "description": {
      "displayName": "Discord",
      "name": "discord",
      "inputs": [
        {
          "name": "main",
          "type": "main"
        }
      ],
      "outputs": [
        {
          "name": "main",
          "type": "main"
        }
      ]
    },
    "properties": {
      "parameters": [
        {
          "name": "resource",
          "display_name": "Resource",
          "type": "OPTIONS",
          "options": [
            {
              "name": "Channel",
              "value": "channel"
            },
            {
              "name": "Message",
              "value": "message"
            },
            {
              "name": "Member",
              "value": "member"
            }
          ],
          "default": "channel",
          "description": "The resource to operate on"
        },
        {
          "name": "authentication",
          "display_name": "Connection Type",
          "type": "OPTIONS",
          "options": [
            {
              "name": "Bot Token",
              "value": "botToken"
            },
            {
              "name": "OAuth2",
              "value": "oAuth2"
            },
            {
              "name": "Webhook",
              "value": "webhook"
            }
          ],
          "default": "botToken"
        }
      ],
      "credentials": [
        {
          "name": "discordBotApi",
          "required": true
        }
      ]
    },
    "operations": [
      {
        "name": "execute",
        "description": "Default operation"
      }
    ],
    "resources": [
      {
        "name": "Channel",
        "value": "channel"
      },
      {
        "name": "Message",
        "value": "message"
      },
      {
        "name": "Member",
        "value": "member"
      }
    ],
    "credentials": [
      {
        "name": "discordBotApi",
        "required": true
      }
    ]
  },
  "trace_map": {
    "correlation_id": "node-discord-v2test-e3e4dbad",
    "node_type": "discord",
    "trace_entries": [
      {
        "field_path": "resources[0]",
        "source": "SOURCE_CODE",
        "evidence": "Resource 'channel' defined in v2/actions/versionDescription.ts",
        "confidence": "high",
        "source_file": "v2/actions/versionDescription.ts"
      },
      {
        "field_path": "resources[1]",
        "source": "SOURCE_CODE",
        "evidence": "Resource 'message' defined in v2/actions/versionDescription.ts",
        "confidence": "high",
        "source_file": "v2/actions/versionDescription.ts"
      },
      {
        "field_path": "resources[2]",
        "source": "SOURCE_CODE",
        "evidence": "Resource 'member' defined in v2/actions/versionDescription.ts",
        "confidence": "high",
        "source_file": "v2/actions/versionDescription.ts"
      },
      {
        "field_path": "credentials[0]",
        "source": "SOURCE_CODE",
        "evidence": "Credential 'discordBotApi' required in v2/actions/versionDescription.ts",
        "confidence": "high",
        "source_file": "v2/actions/versionDescription.ts"
      },
      {
        "field_path": "operations[0]",
        "source": "ASSUMPTION",
        "evidence": "No operations found in source; defaulting to single 'execute' operation",
        "confidence": "low",
        "assumption_rationale": "Source may be incomplete or use different patterns"
      }
    ],
    "generated_at": "2026-01-06T04:47:26.958056",
    "skill_version": "1.0.0",
    "_hybrid_metadata": {
      "source_type": "TYPE1",
      "extraction_confidence": 0.7,
      "advisor_used": false,
      "assumption_ratio": 0.2,
      "deterministic_operations": 4,
      "assumption_operations": 1
    }
  },
  "tests_passed": false,
  "validation_passed": true,
  "fix_iterations": 0,
  "source_files": [],
  "source_hash": null
}